import random
import streamlit as st

# -------------------------
# ãƒšãƒ¼ã‚¸è¨­å®š
# -------------------------
st.set_page_config(
    page_title="æ¯æ—¥ã‚²ãƒ¼ãƒ ãŠé¡Œãƒ¡ãƒ¼ã‚«ãƒ¼",
    page_icon="ğŸ®",
    layout="centered"
)

# -------------------------
# ã¡ã‚‡ã£ã¨ãƒãƒƒãƒ—ãªã‚¹ã‚¿ã‚¤ãƒ«
# -------------------------
POP_CSS = """
<style>
/* èƒŒæ™¯ã‚’ã»ã‚“ã®ã‚Šã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã£ã½ã */
.stApp {
    background: linear-gradient(135deg, #ffe9f3 0%, #e6f3ff 50%, #fff9e6 100%);
}

/* ã‚¿ã‚¤ãƒˆãƒ«ã‚’ãƒãƒƒãƒ—ã« */
h1 {
    text-align: center;
    font-weight: 800;
    color: #ff4b91;
}

/* ã‚«ãƒ¼ãƒ‰é¢¨ã‚³ãƒ³ãƒ†ãƒŠ */
.game-card {
    background-color: #ffffffcc;
    border-radius: 16px;
    padding: 16px 20px;
    margin-top: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

/* è¦‹å‡ºã—ã®ãƒ©ãƒ™ãƒ« */
.game-label {
    font-size: 0.9rem;
    font-weight: 700;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 0.08em;
}

/* ä¸­èº«ã®ãƒ†ã‚­ã‚¹ãƒˆ */
.game-text {
    font-size: 1.1rem;
    font-weight: 600;
    margin-top: 4px;
}

/* å°ã•ã‚ã®è£œè¶³ãƒ†ã‚­ã‚¹ãƒˆ */
.game-subtext {
    font-size: 0.9rem;
    color: #555;
}
</style>
"""

st.markdown(POP_CSS, unsafe_allow_html=True)

# -------------------------
# ãƒ‡ãƒ¼ã‚¿å®šç¾©
# -------------------------

GENRES = [
    "ãƒŸãƒ‹ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°",
    "è½ã¡ã‚‚ã®ãƒ‘ã‚ºãƒ«",
    "ãƒªã‚ºãƒ ã‚²ãƒ¼ãƒ ",
    "åå°„ç¥çµŒã‚²ãƒ¼ãƒ ",
    "ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—ã‚¢ã‚¯ã‚·ãƒ§ãƒ³",
    "è¿·è·¯ã‚²ãƒ¼ãƒ ",
    "ã‚¿ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ•ã‚§ãƒ³ã‚¹é¢¨",
    "ãƒ©ãƒ³ã‚²ãƒ¼ãƒ ï¼ˆæ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰",
    "ã‚¯ãƒªãƒƒã‚¯é€£æ‰“ã‚²ãƒ¼ãƒ ",
    "ã‚¿ã‚¤ãƒŸãƒ³ã‚°ç³»ã‚²ãƒ¼ãƒ ",
]

CONSTRAINTS = [
    "1ç”»é¢ã ã‘ã§å®Œçµã•ã›ã‚‹",
    "æ“ä½œã¯ãƒœã‚¿ãƒ³1ã¤ã ã‘ã«ã™ã‚‹",
    "æ•µï¼ˆã¾ãŸã¯éšœå®³ç‰©ï¼‰ã¯3ç¨®é¡ä»¥å†…ã«ã™ã‚‹",
    "1ãƒ—ãƒ¬ã‚¤30ç§’ä»¥å†…ã§çµ‚ã‚ã‚‹ã‚ˆã†ã«ã™ã‚‹",
    "ã‚¹ã‚³ã‚¢ã‹ã‚¿ã‚¤ãƒ ã®ã©ã¡ã‚‰ã‹ã ã‘ã‚’ä½¿ã†",
    "ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ä¸€åˆ‡å…¥ã‚Œãªã„ï¼ˆç›´æ„Ÿã§éŠã¹ã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼‰",
    "ã‚µã‚¦ãƒ³ãƒ‰ãªã—ã§ã‚‚æˆã‚Šç«‹ã¤ã‚ˆã†ã«ä½œã‚‹",
    "UIã®ãƒœã‚¿ãƒ³ã¯3ã¤ä»¥å†…ã«ãŠã•ã‚ã‚‹",
    "èƒŒæ™¯ã¯å˜è‰²ã‹ã‚°ãƒ©ãƒ‡ã ã‘ã«ã™ã‚‹",
    "ãƒ«ãƒ¼ãƒ«èª¬æ˜ã¯ä¸€æ–‡ã ã‘ã§ä¼ãˆã‚‹",
]

TWISTS = [
    "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨æ•µã®ç«‹å ´ãŒé€”ä¸­ã§å…¥ã‚Œæ›¿ã‚ã‚‹",
    "ãƒŸã‚¹ã™ã‚‹ã¨é€†ã«ã‚¹ã‚³ã‚¢ãŒå¢—ãˆã‚‹ãªã©â€œé€†å¼µã‚Šãƒ«ãƒ¼ãƒ«â€ã‚’1ã¤å…¥ã‚Œã‚‹",
    "ä¸€å®šæ™‚é–“ã”ã¨ã«ç”»é¢ã®è‰²ãŒã‚¬ãƒ©ãƒƒã¨å¤‰ã‚ã‚‹æ¼”å‡ºã‚’å…¥ã‚Œã‚‹",
    "ãƒ©ã‚¹ãƒˆ5ç§’ã ã‘è¶…ãƒã‚¤ãƒ†ãƒ³ãƒã«ãªã‚‹ãƒ¢ãƒ¼ãƒ‰ã‚’å…¥ã‚Œã‚‹",
    "ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ™‚ã«â€œæ¬¡ã®ãƒ’ãƒ³ãƒˆâ€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹",
    "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ”»æ’ƒï¼ˆã¾ãŸã¯æ“ä½œï¼‰ãŒã ã‚“ã ã‚“æš´èµ°ã—ã¦ã„ãè¡¨ç¾ã‚’å…¥ã‚Œã‚‹",
    "ã‚¹ã‚³ã‚¢ã§ã¯ãªãâ€œå¤±æ•—å›æ•°â€ã§æˆé•·ã—ã¦ã„ãè¦ç´ ã‚’å…¥ã‚Œã‚‹",
    "ã‚¿ã‚¤ãƒˆãƒ«ç”»é¢ã«ã¡ã‚‡ã£ã¨ã—ãŸéš ã—ã‚®ãƒŸãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹",
    "ã‚²ãƒ¼ãƒ ä¸­ã«ä¸€åº¦ã ã‘â€œå¥‡è·¡ã®é€†è»¢ãƒãƒ£ãƒ³ã‚¹â€ã‚’ç”¨æ„ã™ã‚‹",
    "ãƒ—ãƒ¬ã‚¤ã”ã¨ã«ãƒ«ãƒ¼ãƒ«ãŒå°‘ã—ã ã‘å¤‰åŒ–ã™ã‚‹â€œæ°—ã¾ãã‚Œãƒ«ãƒ¼ãƒ«â€ã‚’å…¥ã‚Œã‚‹",
]

TOOLS_HINTS = [
    "2Dã‚²ãƒ¼ãƒ ãªã‚‰ Unity ã‹ Godot ã‚ãŸã‚ŠãŒä½œã‚Šã‚„ã™ãã†ã€‚",
    "ãƒ–ãƒ©ã‚¦ã‚¶ã‚²ãƒ¼ãƒ ã«ã™ã‚‹ãªã‚‰ HTML5 + JavaScript ã‹ Python + pygame ã‚‚ã‚¢ãƒªã€‚",
    "ã‚¹ã‚³ã‚¢ã ã‘ã®ã‚·ãƒ³ãƒ—ãƒ«ã‚²ãƒ¼ãƒ ãªã‚‰ Streamlit ã§ã‚‚æ„å¤–ã¨ã‚¤ã‚±ã‚‹ã€‚",
    "ã¾ãšã¯ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’ã‚ã¡ã‚ƒã‚·ãƒ³ãƒ—ãƒ«ã«ä½œã£ã¦ã‹ã‚‰ã€æ¼”å‡ºã ã‘è¶³ã—ã¦ã„ãã¨æ¥½ã€‚",
    "1æ—¥1æœ¬ãŒç›®æ¨™ã ã‹ã‚‰ã€ã¾ãšã¯â€œå‹•ãâ€ã“ã¨ã‚’æœ€å„ªå…ˆã«ã—ã‚ˆã†ã€‚",
]

def make_title(genre: str, constraint: str) -> str:
    """ã‚¸ãƒ£ãƒ³ãƒ«ã¨ç¸›ã‚Šã‹ã‚‰ã€ã‚¿ã‚¤ãƒˆãƒ«ã£ã½ã„åå‰ã‚’ã–ã£ãã‚Šç”Ÿæˆ"""
    bases = [
        f"{genre}ï¼š{constraint.split('ã€')[0]}",
        f"{genre}ãƒ»ãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼",
        f"{genre} 30sec",
        f"ONE BUTTON {genre}",
        f"Crazy {genre}",
        f"{genre} Re:Mix",
    ]
    return random.choice(bases)

def estimate_difficulty(genre: str, constraint: str) -> str:
    """ãªã‚“ã¨ãªãé›£æ˜“åº¦ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿”ã™ï¼ˆä½“æ„Ÿç”¨ï¼‰"""
    score = 0

    if "ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°" in genre or "ã‚¿ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ•ã‚§ãƒ³ã‚¹" in genre:
        score += 2
    if "è¿·è·¯" in genre or "ãƒ©ãƒ³ã‚²ãƒ¼ãƒ " in genre:
        score += 1

    if "æ“ä½œã¯ãƒœã‚¿ãƒ³1ã¤ã ã‘" in constraint:
        score -= 1
    if "1ç”»é¢ã ã‘ã§å®Œçµ" in constraint:
        score -= 1
    if "1ãƒ—ãƒ¬ã‚¤30ç§’" in constraint:
        score -= 0  # ãã“ã¾ã§å¤‰ã‚ã‚‰ãªã„æƒ³å®š

    if score <= 0:
        return "â˜…â˜†â˜†ï¼šä»Šæ—¥ã®1æœ¬ç›®ã«ã¡ã‚‡ã†ã©ã„ã„ãƒ©ã‚¤ãƒˆé›£æ˜“åº¦ã€‚"
    elif score == 1:
        return "â˜…â˜…â˜†ï¼šå°‘ã—ã ã‘è€ƒãˆã‚‹è¦ç´ ã‚ã‚Šã€‚ã‚¦ã‚©ãƒ¼ãƒŸãƒ³ã‚°ã‚¢ãƒƒãƒ—ã«æœ€é©ã€‚"
    else:
        return "â˜…â˜…â˜…ï¼šã—ã£ã‹ã‚Šä½œã‚Šè¾¼ã‚ã‚‹ã‚¿ã‚¤ãƒ—ã€‚2ã€œ3æ—¥ã«åˆ†ã‘ã¦ã‚‚OKã‹ã‚‚ã€‚"

# -------------------------
# ç”»é¢æœ¬ä½“
# -------------------------

st.title("ğŸ® æ¯æ—¥ã‚²ãƒ¼ãƒ ãŠé¡Œãƒ¡ãƒ¼ã‚«ãƒ¼")

st.markdown(
    "ã€Œ**ä»Šæ—¥ã®1æœ¬ã€ä½•ä½œã‚ã†â€¦ï¼Ÿ**ã€ã¨æ€ã£ãŸã¨ãç”¨ã®ã€<br>"
    "**ãŠé¡Œã‚¬ãƒãƒ£ã‚¢ãƒ—ãƒª**ã ã‚ˆã€‚<br>"
    "ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ã‚¸ãƒ£ãƒ³ãƒ«ï¼‹ç¸›ã‚Šï¼‹ã²ã­ã‚Šã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ã¾ã¨ã‚ã¦å‡ºã™ã­ï¼",
    unsafe_allow_html=True,
)

st.write("")

if st.button("ğŸ² ä»Šæ—¥ã®ã‚²ãƒ¼ãƒ ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ç”Ÿæˆï¼", use_container_width=True):
    genre = random.choice(GENRES)
    constraint = random.choice(CONSTRAINTS)
    twist = random.choice(TWISTS)
    title = make_title(genre, constraint)
    diff_text = estimate_difficulty(genre, constraint)
    tool_hint = random.choice(TOOLS_HINTS)

    st.markdown(
        f"""
        <div class="game-card">
          <div class="game-label">ä»Šæ—¥ã®ã‚¿ã‚¤ãƒˆãƒ«æ¡ˆ</div>
          <div class="game-text">ğŸ® {title}</div>
          <div class="game-subtext">
            â€»ã‚¿ã‚¤ãƒˆãƒ«ã¯è‡ªç”±ã«ã‚¢ãƒ¬ãƒ³ã‚¸OKã€‚æ€ã„ã¤ã„ãŸã‚‰ãã®å ´ã§å¤‰ãˆã¡ã‚ƒãŠã†ã€‚
          </div>
        </div>
        """,
        unsafe_allow_html=True,
    )

    st.markdown(
        f"""
        <div class="game-card">
          <div class="game-label">ã‚¸ãƒ£ãƒ³ãƒ«</div>
          <div class="game-text">ğŸ² {genre}</div>
        </div>
        """,
        unsafe_allow_html=True,
    )

    st.markdown(
        f"""
        <div class="game-card">
          <div class="game-label">åˆ¶ä½œã®â€œç¸›ã‚Šâ€</div>
          <div class="game-text">ğŸ§± {constraint}</div>
        </div>
        """,
        unsafe_allow_html=True,
    )

    st.markdown(
        f"""
        <div class="game-card">
          <div class="game-label">ã²ã¨ã²ã­ã‚Šã‚¢ã‚¤ãƒ‡ã‚¢</div>
          <div class="game-text">ğŸ’¡ {twist}</div>
        </div>
        """,
        unsafe_allow_html=True,
    )

    st.markdown(
        f"""
        <div class="game-card">
          <div class="game-label">é›£æ˜“åº¦ã‚¤ãƒ¡ãƒ¼ã‚¸</div>
          <div class="game-text">ğŸ“Œ {diff_text}</div>
        </div>
        """,
        unsafe_allow_html=True,
    )

    st.markdown(
        f"""
        <div class="game-card">
          <div class="game-label">é–‹ç™ºãƒ¡ãƒ¢</div>
          <div class="game-text">ğŸ›  {tool_hint}</div>
        </div>
        """,
        unsafe_allow_html=True,
    )

else:
    st.info("â¬†ï¸ ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ä»Šæ—¥ã®ã‚²ãƒ¼ãƒ ãŠé¡ŒãŒãƒãƒ³ã£ã¨å‡ºã‚‹ã‚ˆï¼")

st.write("")
st.caption("æ¯æ—¥1æœ¬ã˜ã‚ƒãªãã¦ã‚‚OKã€‚ä½œã‚ŒãŸæ—¥ã¯è‡ªåˆ†ã‚’è¤’ã‚ã‚‹æ—¥")
